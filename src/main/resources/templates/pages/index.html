<!DOCTYPE html>
<html
    lang="en"
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layouts/layout}"
>
    <th:block layout:fragment="javascript">
        <!-- 주소 검색 api -->
        <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
        <!-- 지도 api -->
        <script
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=b8f20a221506b373bac69207f38af4f7&libraries=services"
        ></script>
        <script>
            function toggleChat() {
                var chatBox = document.getElementById("chatBox");
                if (chatBox.style.display === "none") {
                    chatBox.style.display = "block";
                } else {
                    chatBox.style.display = "none";
                }
            }
        </script>
    </th:block>
    <th:block layout:fragment="title">
        <title>index page</title>
    </th:block>
    <th:block layout:fragment="css"><link rel="stylesheet" th:href="@{/css/pages/index.css}" /></th:block>
    <th:block layout:fragment="main">
        <div class="indexContainer">
            <section th:replace="~{fragments/index/mainSection_frag::mainSection}"></section>
            <section th:replace="~{fragments/index/conditionalSection_frag::conditionalSection}"></section>
            <section></section>
        </div>
        <div class="container">
            <h1>CHATBOX TEST</h1>
            <!-- Your content here -->
            
            <button class="btn btn-primary" onclick="toggleChat()">Chat with us</button>
    
            <div id="chatBox" style="display:none; position:fixed; bottom:0; right:0; width:300px; height:400px; background:white; border:1px solid #ccc; padding:10px;">
                <h2>Chat Room</h2>
                <ul id="messages"></ul>
                <input type="text" id="messageInput" placeholder="Enter your message"/>
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>
        
        <script>
            var socket = new WebSocket("ws://localhost:8080/chat");
            socket.onmessage = function(event) {
                var messages = document.getElementById("messages");
                var message = document.createElement("li");
                message.appendChild(document.createTextNode(event.data));
                messages.appendChild(message);
            };
    
            function sendMessage() {
                var input = document.getElementById("messageInput");
                socket.send(input.value);
                input.value = '';
            }
        </script>

        <script th:src="@{/js/index/kakaoMapAPI.js}"></script>
        <script th:src="@{/js/index/index_scroll.js}"></script>
    </th:block>
</html>
