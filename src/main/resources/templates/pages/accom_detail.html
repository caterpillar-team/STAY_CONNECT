<!DOCTYPE html>
<html
        lang="en"
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layouts/layout}"
>
<head>
    <!-- PortOne -->
    <script src="https://cdn.iamport.kr/v1/iamport.js"></script>
    <!--axios cdn    -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js" integrity="sha512-JSCFHhKDilTRRXe9ak/FJ28dcpOJxzQaCd3Xg8MyF6XFjODhy/YMCM8HW0TFDckNHWUewW+kfvhin43hKtJxAw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


    <script>
        // 리다이렉팅
        function redirectToURL() {
        window.location.href = "http://localhost:8080/myPage";
    }
        // 결제
        document.addEventListener("DOMContentLoaded", function(){

             IMP.init("imp66857630");

            const payBtn = document.querySelector('.pay_btn');
            payBtn.addEventListener('click',function(){
                console.log("test");

                IMP.request_pay({
                pg: "html5_inicis",
                pay_method: "card",
                merchant_uid: "test_lx7ku3u9",
                name: "테스트 결제",
                amount: 100,
                buyer_tel: "010-0000-0000",
              }, function(resp){
                console.log(resp)

                const SUCCESS = axios.get("/user/paySuccess?success="+resp.success)
                const IMP_UID = axios.get("/user/paySuccess?imp_uid="+resp.imp_uid)

                axios.all([SUCCESS, IMP_UID])
                .then(axios.spread((SUCCESS, IMP_UID) => {
                   console.log("SUCCESS : ", resp.success);
                   console.log("IMP_UID : ", resp.imp_uid);
                }))
                .catch(err => {console.log(err)})
            })
        })
        });


    </script>
    <meta charset="UTF-8">
    <th:block layout:fragment="title">
        <title>Accommodation Detail</title>
    </th:block>

    <!-- Google Icon -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
          rel="stylesheet"/>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }
    </style>
    <!-- bootstrap -->
    <th:block layout:fragment="script">
        <script th:src="@{/libs/bootstrap/bootstrap.min.js}"></script>
    </th:block>
    <th:block layout:fragment="css">
        <link rel="stylesheet" th:href="@{/libs/bootstrap/bootstrap.min.css}"/>
        <link rel="stylesheet" th:href="@{/css/pages/accom_detail.css}"/>
    </th:block>

</head>

<body>
<!-- 날짜검색 fragment 삽입 -->

<!-- fragment main -->
<th:block layout:fragment="main">
    <section class="accomImg">
        <div class="accomImg1">
            <img alt="" th:src="@{/img/StayConnect-main.jpg}" />
        </div>
        <div class="carousel slide" id="carouselExampleIndicators">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img alt="..." class="d-block w-100" th:src="@{/img/StayConnect-main.jpg}">
                </div>
                <div class="carousel-item">
                    <img alt="..." class="d-block w-100" th:src="@{/img/StayConnect_main2.jpg}">
                </div>
                <div class="carousel-item">
                    <img alt="..." class="d-block w-100" th:src="@{/img/StayConnect_main3.jpg}">
                </div>
            </div>
            <button class="carousel-control-prev" data-bs-slide="prev" data-bs-target="#carouselExampleIndicators"
                    type="button">
                <span aria-hidden="true" class="carousel-control-prev-icon"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" data-bs-slide="next" data-bs-target="#carouselExampleIndicators"
                    type="button">
                <span aria-hidden="true" class="carousel-control-next-icon"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </section>
    <section class="accomMain">
        <div>
            <div class="category_name" th:text="${accom.accommodation.category.name}">호텔/펜션</div>
            <div class="accomName" th:text="${accom.accommodation.name}">숙소이름</div>
        </div>
        <div class="">
            <div class="star_rating">★★★★★
<!--                <a th:if="${reviewDto.getAverageRating() != 0}" class="on"  th:each="num : ${#numbers.sequence(0, review.getAverageRating()-1)}">★</a>-->
<!--                <a th:unless="${reviewDto.getAverageRating() != 0}">★★★★★</a>-->
            </div>
            <div class="">평가인원</div>
            <a th:href="@{#}">리뷰보기</a>
        </div>
        <div class="reviewBox">
            <div class="reviewSlider">
                <div th:each="review : ${reviews}">
                    <div class="review">
                        <div class="content" th:text="${review.contents}">리뷰</div>
                        <div class="reviewWriter">
                            <div class="user" th:text="${review.user.username}">닉네임</div>
                            <div class="createdAt" th:text="${#dates.format(review.createdAt, 'yyyy-MM-dd HH:mm')}">시기</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <hr>
    <section class="accomDetail">
        <!--    반복문 수정중    -->
        <div class="accomDetailContainer">
            <div class="accomType">
                <img alt="" th:src="@{/img/StayConnect-main.jpg}">  <!--객실타입사진-->
                <div class="detail">
                    <div class="roomType" th:text="${accom.roomType}">객실타입이름</div>
                    <div class="numberOfPeople">
                        <span class="material-symbols-outlined">person</span>
                        <span class="standard" th:text="${'기준인원 '+accom.numberOfPeopleStandard+'인 / '}">기준인원</span>
                        <span class="max" th:text="${'최대인원 '+accom.numberOfPeopleMax+'인'}">최대인원</span>
                    </div>
                    <div class="bedType">
                        <span class="material-symbols-outlined">bed</span>
                        <span class="bedType" th:text="${accom.bedType}">침대타입</span>
                    </div>
                </div>
            </div>
            <div class="detail">
                <div class="" th:text="${accom.stayType}">숙박/대실</div>
                <div class="">
                    <span th:text="${'체크인 : '+accom.ckiTime}">체크인시간</span>
                    <span>/</span>
                    <span th:text="${'체크아웃 : '+accom.ckoTime}">체크아웃시간</span>
                </div>
                <div class="price" th:text="${accom.price+'원'}">가격</div>
                <div class="cancellationPolicy">취소정책</div>
                <div>
                    <a class="pay_btn" href="javascript:void(0)">예약하기</a>
                </div>
            </div>
        </div>
        <hr>
        <div class="accomDetailContainer">
            <div class="accomType">
                <img alt="" th:src="@{/img/StayConnect-main.jpg}">  <!--객실타입사진-->
                <div class="detail">
                    <div class="roomType" th:text="${accom.roomType}">객실타입이름</div>
                    <div class="numberOfPeople">
                        <span class="material-symbols-outlined">person</span>
                        <span class="standard" th:text="${'기준인원 '+accom.numberOfPeopleStandard+'인 / '}">기준인원</span>
                        <span class="max" th:text="${'최대인원 '+accom.numberOfPeopleMax+'인'}">최대인원</span>
                    </div>
                    <div class="bedType">
                        <span class="material-symbols-outlined">bed</span>
                        <span class="bedType" th:text="${accom.bedType}">침대타입</span>
                    </div>
                </div>
            </div>
            <div class="detail">
                <div class="" th:text="${accom.stayType}">숙박/대실</div>
                <div class="">
                    <span th:text="${'체크인 : '+accom.ckiTime}">체크인시간</span>
                    <span>/</span>
                    <span th:text="${'체크아웃 : '+accom.ckoTime}">체크아웃시간</span>
                </div>
                <div class="price" th:text="${accom.price+'원'}">가격</div>
                <div class="cancellationPolicy">취소정책</div>
                <div>
                    <a th:href="@{#}">예약하기</a>
                </div>
            </div>
        </div>
        <hr>
        <div class="accomDetailContainer">
            <div class="accomType">
                <img alt="" th:src="@{/img/StayConnect-main.jpg}">  <!--객실타입사진-->
                <div class="detail">
                    <div class="roomType" th:text="${accom.roomType}">객실타입이름</div>
                    <div class="numberOfPeople">
                        <span class="material-symbols-outlined">person</span>
                        <span class="standard" th:text="${'기준인원 '+accom.numberOfPeopleStandard+'인 / '}">기준인원</span>
                        <span class="max" th:text="${'최대인원 '+accom.numberOfPeopleMax+'인'}">최대인원</span>
                    </div>
                    <div class="bedType">
                        <span class="material-symbols-outlined">bed</span>
                        <span class="bedType" th:text="${accom.bedType}">침대타입</span>
                    </div>
                </div>
            </div>
            <div class="detail">
                <div class="" th:text="${accom.stayType}">숙박/대실</div>
                <div class="">
                    <span th:text="${'체크인 : '+accom.ckiTime}">체크인시간</span>
                    <span>/</span>
                    <span th:text="${'체크아웃 : '+accom.ckoTime}">체크아웃시간</span>
                </div>
                <div class="price" th:text="${accom.price+'원'}">가격</div>
                <div class="cancellationPolicy">취소정책</div>
                <div>
                    <a th:href="@{#}">예약하기</a>
                </div>
            </div>
        </div>
        <hr>
    <section class="reviewList" th:each="review : ${reviews}">
        <!-- 후기 목록 -->
        <div id="revivewContainer">
            <div class="reviewWriter">
                <img alt="" th:src="@{/img/StayConnect-main.jpg}">  <!--유저프로필사진-->
                <span class="user" th:text="${review.user.username}">닉네임</span>
            </div>
            <form method="POST" th:action="@{/accom_detail}">
                <input type="hidden" id="reviewId" name="reviewId" th:value="${review.id}">
                <div>
                    <input type="button" class="btn p-0 btn-md" name="reviewUser" th:value="${review.user.getUsername()}" />
                    <small th:text="${#strings.substring(review.createdAt,0,19)}"></small>
                </div>
                <div th:text="${review.contents}" ></div>
                <!-- 수정중 -->
                <div class="text-right" th:if="${review.user==review.user}" style="display: none">
                    <span><button type="submit" name="submit" value="update">수정</button></span>
                    <span><button type="submit" name="submit" value="delete">삭제</button></span>
                </div>
            </form>
        </div>
<!--        &lt;!&ndash; 작성란&버튼 &ndash;&gt;-->
<!--        <div class="col justify-content-center my-1 mx-0">-->
<!--            <form method="POST" onsubmit="return checkComment(event)" id="commentForm">-->
<!--                &lt;!&ndash; hidden 영역 &ndash;&gt;-->
<!--                <input type="hidden" name="user" th:value="${review.user.username}">-->
<!--                &lt;!&ndash; 입력 영역 &ndash;&gt;-->
<!--                <input type="text" id="content" name="CONTENT">-->
<!--                <input type="submit" value="후기작성">-->
<!--            </form>-->
<!--        </div>-->
    </section>
</th:block>

        


</body>
</html>